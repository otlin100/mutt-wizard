#!/usr/bin/env bash

properRender() {
    while read line; do
        firstchar=${line:0:1}
        if [[ $firstchar = '0' ]]; then
            sleep 0.1
        fi
        echo "$line"
    done;
}

#get image resolution
resolution=$(identify $1 | awk '{print $3}')
IFS='x' # x is set as delimiter
read -ra ADDR <<< "$resolution"
width=${ADDR[0]}
height=${ADDR[1]}

### Display Image / offset with mutt bar
echo -e "2;3;\n0;1;225;32;$((width));$((height));0;0;0;0;$1\n4;\n3;" | properRender | /usr/lib/w3m/w3mimgdisplay &
